{% extends 'base.html' %}
{% block title %}My Orders - Digicam Shop{% endblock %}

{% block css %}
<style>
    .orders-header {
        background: 
            repeating-linear-gradient(45deg, var(--teal) 0%, #16A085 50%, var(--teal) 100%),
            linear-gradient(135deg, var(--teal), var(--burnt-orange));
        background-size: 30px 30px, 100%;
        color: white;
        padding: 50px 0;
        margin: -30px -15px 30px -15px;
        border-radius: 0;
        border-bottom: 6px double var(--dark-gray);
        position: relative;
    } 
    .orders-header::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: repeating-linear-gradient(90deg, var(--mustard-yellow) 0%, var(--mustard-yellow) 10px, transparent 10px, transparent 20px);
    }
    .orders-header h3 {
        color: white;
        font-size: 3.5rem;
        margin: 0;
        font-family: 'Bebas Neue', 'Oswald', sans-serif;
        text-transform: uppercase;
        letter-spacing: 4px;
        text-shadow: 3px 3px 0px var(--dark-gray);
        position: relative;
    }
    .orders-header h3::before,
    .orders-header h3::after {
        content: '‚ùã';
        color: var(--mustard-yellow);
        font-size: 2rem;
        margin: 0 20px;
    }
    .orders-container {
        background-color: white;
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
</style>
{% endblock %}

{% block content %}
<div class="orders-header text-center">
    <div class="container">
        <h3>My Orders</h3>
        <p class="mt-2">Track your camera purchases</p>
    </div>
</div>

<div class="container">
<div class="orders-container">
<!-- Status Tabs -->
<!-- Status Tabs -->
<ul class="nav nav-tabs mb-4">
    <li class="nav-item">
        <a class="nav-link {% if status in ['Pending', 'Approved'] %}active{% endif %}"
           href="{{ url_for('orders', status='Processing') }}">
            Processing
            <span class="badge bg-secondary ms-1">{{ counts.Processing }}</span>
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link {% if status == 'Shipped' %}active{% endif %}"
           href="{{ url_for('orders', status='Shipped') }}">
            Shipped
            <span class="badge bg-secondary ms-1">{{ counts.Shipped }}</span>
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link {% if status == 'Delivered' %}active{% endif %}"
           href="{{ url_for('orders', status='Delivered') }}">
            Delivered
            <span class="badge bg-secondary ms-1">{{ counts.Delivered }}</span>
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link {% if status == 'Declined' %}active{% endif %}"
           href="{{ url_for('orders', status='Declined') }}">
            Declined    
            <span class="badge bg-secondary ms-1">{{ counts.Declined }}</span>
        </a>
    </li>
</ul>


{% if orders %}
<table class="table table-bordered align-middle">
    <thead class="table-dark">
        <tr>
            <th>Order #</th>
            <th>Date</th>
            <th>Payment</th>
            <th>Status</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
        {% for o in orders %}
        <tr>
            <td><strong>#{{ o.id }}</strong></td>
            <td>{{ o.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
            <td>{{ o.payment_method }}</td>
           <td>
  <span class="badge
      {% if o.status == 'Pending' %}bg-warning
      {% elif o.status == 'Approved' %}bg-primary
      {% elif o.status == 'Shipped' %}bg-info
      {% elif o.status == 'Delivered' %}bg-success
      {% elif o.status == 'Declined' %}bg-danger
      {% else %}bg-secondary{% endif %}">
      {{ o.status }}
  </span>
</td>


            <td>
                <a href="{{ url_for('order_details', id=o.id) }}"
                   class="btn btn-sm btn-outline-dark">
                    View Details
                </a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Pagination -->
<nav>
    <ul class="pagination justify-content-center">

        {% if page > 1 %}
        <li class="page-item">
            <a class="page-link"
               href="{{ url_for('orders', status=status, page=page-1) }}">
                Previous
            </a>
        </li>
        {% endif %}

        {% for p in range(1, total_pages + 1) %}
        <li class="page-item {% if p == page %}active{% endif %}">
            <a class="page-link"
               href="{{ url_for('orders', status=status, page=p) }}">
                {{ p }}
            </a>
        </li>
        {% endfor %}

        {% if page < total_pages %}
        <li class="page-item">
            <a class="page-link"
               href="{{ url_for('orders', status=status, page=page+1) }}">
                Next
            </a>
        </li>
        {% endif %}

    </ul>
</nav>

{% else %}
<div class="alert alert-info text-center">
    <h5>No {{ status }} orders found.</h5>
    <p class="mb-0">Start shopping to see your orders here!</p>
</div>
{% endif %}
</div>
</div>
{% endblock %}
