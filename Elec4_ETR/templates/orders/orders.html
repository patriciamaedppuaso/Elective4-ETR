{% extends 'base.html' %}
{% block title %}My Orders - Digicam Shop{% endblock %}

{% block css %}
<style>
    .orders-header {
        background: linear-gradient(135deg, var(--teal), var(--burnt-orange));
        color: white;
        padding: 40px 0;
        margin: -30px -15px 30px -15px;
        border-radius: 0 0 20px 20px;
    }
    .orders-header h3 {
        color: white;
        font-size: 2.5rem;
        margin: 0;
    }
    .orders-container {
        background-color: white;
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
</style>
{% endblock %}

{% block content %}
<div class="orders-header text-center">
    <div class="container">
        <h3>ðŸ“¦ My Orders</h3>
        <p class="mt-2">Track your camera purchases</p>
    </div>
</div>

<div class="container">
<div class="orders-container">
<!-- Status Tabs -->
<ul class="nav nav-tabs mb-4">

    <li class="nav-item">
        <a class="nav-link {% if status == 'Pending' %}active{% endif %}"
           href="{{ url_for('orders', status='Pending') }}">
            Pending
            <span class="badge bg-secondary ms-1">
                {{ counts.Pending }}
            </span>
        </a>
    </li>

    <li class="nav-item">
        <a class="nav-link {% if status == 'Approved' %}active{% endif %}"
           href="{{ url_for('orders', status='Approved') }}">
            Approved
            <span class="badge bg-secondary ms-1">
                {{ counts.Approved }}
            </span>
        </a>
    </li>

    <li class="nav-item">
        <a class="nav-link {% if status == 'Declined' %}active{% endif %}"
           href="{{ url_for('orders', status='Declined') }}">
            Declined    
            <span class="badge bg-secondary ms-1">
                {{ counts.Declined }}
            </span>
        </a>
    </li>

</ul>


{% if orders %}
<table class="table table-bordered align-middle">
    <thead class="table-dark">
        <tr>
            <th>Order #</th>
            <th>Date</th>
            <th>Payment</th>
            <th>Status</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
        {% for o in orders %}
        <tr>
            <td><strong>#{{ o.id }}</strong></td>
            <td>{{ o.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
            <td>{{ o.payment_method }}</td>
            <td>
                <span class="badge
                    {% if o.status == 'Pending' %}bg-warning
                    {% elif o.status == 'Approved' %}bg-success
                    {% else %}bg-danger{% endif %}">
                    {{ o.status }}
                </span>
            </td>
            <td>
                <a href="{{ url_for('order_details', id=o.id) }}"
                   class="btn btn-sm btn-outline-dark">
                    View Details
                </a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Pagination -->
<nav>
    <ul class="pagination justify-content-center">

        {% if page > 1 %}
        <li class="page-item">
            <a class="page-link"
               href="{{ url_for('orders', status=status, page=page-1) }}">
                Previous
            </a>
        </li>
        {% endif %}

        {% for p in range(1, total_pages + 1) %}
        <li class="page-item {% if p == page %}active{% endif %}">
            <a class="page-link"
               href="{{ url_for('orders', status=status, page=p) }}">
                {{ p }}
            </a>
        </li>
        {% endfor %}

        {% if page < total_pages %}
        <li class="page-item">
            <a class="page-link"
               href="{{ url_for('orders', status=status, page=page+1) }}">
                Next
            </a>
        </li>
        {% endif %}

    </ul>
</nav>

{% else %}
<div class="alert alert-info text-center">
    <h5>No {{ status }} orders found.</h5>
    <p class="mb-0">Start shopping to see your orders here!</p>
</div>
{% endif %}
</div>
</div>
{% endblock %}
